#!/usr/bin/env python

from project_tools.tools.FlaskNikto.Nikto.utils import scanner
from project_tools.tools.FlaskNikto.Nikto.utils.parser import parse

def vulscan(target_url):
    try:
        res=parse(target_url)
        if not res.get("status"):
            return {"status":"Error","payload": res.get("error")} 
        vuln_scanner = scanner.Scanner(target_url)
        print("CRAWLING THE WEB: ")
        vuln_scanner.crawl()
        print("Crawling finished")
        print("Starting XSS Scan")
        vuln_scanner.run_scanner()
        print("XSS Scan finished.\n")
    except:
        return {"Status": "Error", "Error": "Invalid input format"}
    # print("Starting SQLi scan ")
    # vuln_scanner.sql_injection_scan(target_url)
    # print("SQLi scan finished")