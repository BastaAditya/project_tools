#!/usr/bin/env python

from Nikto.utils import scanner
from Nikto.utils.parser import parse

def vulscan(target_url):
    res=parse(target_url)
    if not res.get("status"):
        return {"status":"Error","payload": res.get("error")} 
    vuln_scanner = scanner.Scanner(target_url)
    print("CRAWLING THE WEB: ")
    vuln_scanner.crawl()
    print("Crawling finished")
    print("Starting XSS Scan")
    vuln_scanner.run_scanner()
    print("XSS Scan finished.\n")
    # print("Starting SQLi scan ")
    # vuln_scanner.sql_injection_scan(target_url)
    # print("SQLi scan finished")